---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

const allPosts = await getCollection('blog');
// Group posts by themes/ideas rather than strict chronology
const sortedPosts = allPosts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

// Identify recent vs established thoughts
const currentYear = new Date().getFullYear();
const recentThoughts = sortedPosts.filter(p => p.data.date.getFullYear() >= currentYear - 1);
const establishedThoughts = sortedPosts.filter(p => p.data.date.getFullYear() < currentYear - 1);
---

<Layout title="Ongoing Thoughts - Christopher de Beer">
  <main>
    <div class="content-container">
      <header class="thoughts-header">
        <h1>Ongoing Thoughts</h1>
        <p class="subtitle">Ideas in various stages of development and exploration</p>
      </header>
      
      <section class="thoughts-intro">
        <p>This space captures thinking in progress—some ideas newly formed, others that have had time to develop and mature. Rather than organizing strictly by publication date, these thoughts are grouped to show the natural rhythm of exploration and development.</p>
        
        <p>Each piece connects to others through shared themes visible in the <a href="/tags/">emergent patterns</a>, creating a web of interconnected ideas that grows organically over time.</p>
      </section>

      {recentThoughts.length > 0 && (
        <section class="thought-cluster">
          <h2 class="cluster-title">Current Thinking</h2>
          <p class="cluster-intro">Recent explorations and fresh ideas currently taking shape:</p>
          
          <div class="thought-flow">
            {recentThoughts.map((post) => (
              <article class="thought-entry">
                <h3 class="thought-title">
                  <a href={`/blog/${post.slug}/`}>{post.data.title}</a>
                </h3>
                {post.data.description && (
                  <p class="thought-summary">{post.data.description}</p>
                )}
                {post.data.tags && (
                  <div class="thought-connections">
                    <span class="connection-label">Connects to:</span>
                    {post.data.tags.map((tag) => (
                      <span class="connection-thread">{tag}</span>
                    ))}
                  </div>
                )}
              </article>
            ))}
          </div>
        </section>
      )}

      {establishedThoughts.length > 0 && (
        <section class="thought-cluster">
          <h2 class="cluster-title">Established Thinking</h2>
          <p class="cluster-intro">Ideas that have had time to develop and mature through reflection:</p>
          
          <div class="thought-flow">
            {establishedThoughts.map((post) => (
              <article class="thought-entry">
                <h3 class="thought-title">
                  <a href={`/blog/${post.slug}/`}>{post.data.title}</a>
                </h3>
                {post.data.description && (
                  <p class="thought-summary">{post.data.description}</p>
                )}
                {post.data.tags && (
                  <div class="thought-connections">
                    <span class="connection-label">Connects to:</span>
                    {post.data.tags.map((tag) => (
                      <span class="connection-thread">{tag}</span>
                    ))}
                  </div>
                )}
              </article>
            ))}
          </div>
        </section>
      )}
      
      <footer class="thoughts-reflection">
        <p>These thoughts intersect with ongoing <a href="/projects/">explorations</a> and contribute to the evolving <a href="/tags/">thematic patterns</a> that emerge through sustained inquiry and making.</p>
        
        <p class="meta-note">
          <em>Note: The organization here prioritizes conceptual development over chronological sequence—another manifestation of digital garden principles where ideas, not dates, drive the structure.</em>
        </p>
      </footer>
    </div>
  </main>
</Layout>

<style>
  .thoughts-header {
    margin-bottom: 3rem;
    text-align: center;
  }

  .thoughts-header h1 {
    font-size: 2.4em;
    margin-bottom: 0.5rem;
    color: var(--text-primary);
    font-weight: 400;
  }

  .subtitle {
    font-size: 1.1em;
    color: var(--text-secondary);
    font-style: italic;
    margin: 0;
    line-height: 1.5;
  }

  .thoughts-intro {
    margin-bottom: 3rem;
    padding: 2rem;
    background: var(--background-subtle);
    border-left: 3px solid var(--accent);
  }

  .thoughts-intro p {
    font-size: 1.05em;
    line-height: 1.7;
    color: var(--text-primary);
    margin-bottom: 1.5rem;
  }

  .thoughts-intro p:last-child {
    margin-bottom: 0;
  }

  .thoughts-intro a {
    color: var(--accent);
    text-decoration: none;
  }

  .thoughts-intro a:hover {
    text-decoration: underline;
  }

  .thought-cluster {
    margin-bottom: 3rem;
  }

  .cluster-title {
    font-size: 1.6em;
    margin: 0 0 1rem 0;
    color: var(--text-primary);
    font-weight: 400;
    border-bottom: 1px solid var(--border-light);
    padding-bottom: 0.5rem;
  }

  .cluster-intro {
    font-size: 1em;
    color: var(--text-secondary);
    margin-bottom: 2rem;
    font-style: italic;
    line-height: 1.6;
  }

  .thought-flow {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .thought-entry {
    padding: 1.5rem 0;
    border-bottom: 1px solid var(--border-light);
  }

  .thought-entry:last-child {
    border-bottom: none;
  }

  .thought-title {
    font-size: 1.3em;
    margin: 0 0 0.75rem 0;
    font-weight: 400;
  }

  .thought-title a {
    color: var(--text-primary);
    text-decoration: none;
    transition: color 0.15s ease;
  }

  .thought-title a:hover {
    color: var(--accent);
  }

  .thought-summary {
    color: var(--text-primary);
    line-height: 1.6;
    margin-bottom: 1rem;
    font-size: 1em;
  }

  .thought-connections {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
    align-items: center;
  }

  .connection-label {
    font-size: 0.85em;
    color: var(--text-secondary);
    font-style: italic;
  }

  .connection-thread {
    font-size: 0.8em;
    color: var(--accent);
    background: var(--background-subtle);
    padding: 0.25rem 0.6rem;
    border-radius: 12px;
    border: 1px solid var(--border);
  }

  .thoughts-reflection {
    padding-top: 2rem;
    border-top: 1px solid var(--border);
    color: var(--text-secondary);
  }

  .thoughts-reflection p {
    margin-bottom: 1.5rem;
    line-height: 1.6;
  }

  .thoughts-reflection a {
    color: var(--accent);
    text-decoration: none;
  }

  .thoughts-reflection a:hover {
    text-decoration: underline;
  }

  .meta-note {
    font-size: 0.9em;
    padding: 1.5rem;
    background: var(--background-subtle);
    border-radius: 4px;
    margin-top: 1rem;
  }

  .meta-note em {
    color: var(--text-secondary);
  }

  @media (max-width: 768px) {
    .thoughts-header h1 {
      font-size: 2em;
    }
    
    .thoughts-intro {
      padding: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .cluster-title {
      font-size: 1.4em;
    }
    
    .thought-entry {
      padding: 1.25rem 0;
    }
    
    .thought-connections {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }
  }
</style>