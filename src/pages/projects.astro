---
import Layout from '../layouts/Layout.astro';
import fs from 'fs';
import path from 'path';

// Read all project files and group them by natural themes that emerged over time
const projectsDir = path.join(process.cwd(), 'projects');
const allProjects = fs.readdirSync(projectsDir)
  .filter(file => file.endsWith('.md') && file !== 'README.md')
  .map(file => {
    const content = fs.readFileSync(path.join(projectsDir, file), 'utf-8');
    const title = file.replace('.md', '');
    
    // Extract creation date to understand the timeline of exploration
    const lines = content.split('\n');
    const createdLine = lines.find(line => line.includes('**Created:**'));
    const createdDate = createdLine ? new Date(createdLine.split('**Created:**')[1]?.trim()) : new Date();
    
    const summaryStart = lines.findIndex(line => line.includes('## Summary'));
    const summary = summaryStart !== -1 ? lines[summaryStart + 2]?.replace(/^"|"$/g, '') || '' : '';
    
    const githubLine = lines.find(line => line.includes('**GitHub Source:**'));
    const githubUrl = githubLine ? githubLine.match(/https:\/\/github\.com\/[^\s]+/)?.[0] || '' : '';
    
    return {
      title,
      summary,
      githubUrl,
      createdDate,
      filename: file
    };
  })
  .sort((a, b) => b.createdDate.getTime() - a.createdDate.getTime()); // Newest first - showing evolution

// Group by approximate time periods to show the journey
const currentYear = new Date().getFullYear();
const recentProjects = allProjects.filter(p => p.createdDate.getFullYear() >= currentYear - 1);
const earlyProjects = allProjects.filter(p => p.createdDate.getFullYear() < currentYear - 1);
---

<Layout title="Explorations & Experiments - Christopher de Beer">
	<main class="content-container">
		<header class="workshop-header">
			<h1>Explorations & Experiments</h1>
			<p class="subtitle">A maker's journey through code, ideas, and digital experiments</p>
		</header>
		
		<section class="workshop-intro">
			<p>This is where ideas take shape and curiosity drives creation. Each project represents a moment of exploration—some recent and actively evolving, others from earlier phases of learning and experimentation. Together, they form a narrative of continuous discovery.</p>
			
			<p>Rather than organizing these by technology or purpose, they're arranged chronologically to show the natural evolution of interests and capabilities. This is how digital gardens grow: organically, following curiosity rather than predetermined categories.</p>
		</section>

		{recentProjects.length > 0 && (
			<section class="time-cluster">
				<h2 class="period-title">Current & Recent Explorations</h2>
				<p class="period-intro">These projects represent my most recent areas of investigation and active development:</p>
				
				<div class="project-flow">
					{recentProjects.map(project => (
						<article class="project-exploration">
							<h3 class="project-name">
								<a href={`/projects/${project.filename.replace('.md', '')}/`}>{project.title}</a>
							</h3>
							<p class="project-narrative">{project.summary}</p>
							<div class="exploration-links">
								<a href={`/projects/${project.filename.replace('.md', '')}/`} class="explore-link">Explore this work →</a>
								{project.githubUrl && (
									<a href={project.githubUrl} target="_blank" rel="noopener" class="source-link">Source</a>
								)}
							</div>
						</article>
					))}
				</div>
			</section>
		)}

		{earlyProjects.length > 0 && (
			<section class="time-cluster">
				<h2 class="period-title">Earlier Experiments</h2>
				<p class="period-intro">These projects capture earlier phases of exploration and learning—each one representing a different curiosity or technical investigation:</p>
				
				<div class="project-flow">
					{earlyProjects.map(project => (
						<article class="project-exploration">
							<h3 class="project-name">
								<a href={`/projects/${project.filename.replace('.md', '')}/`}>{project.title}</a>
							</h3>
							<p class="project-narrative">{project.summary}</p>
							<div class="exploration-links">
								<a href={`/projects/${project.filename.replace('.md', '')}/`} class="explore-link">Explore this work →</a>
								{project.githubUrl && (
									<a href={project.githubUrl} target="_blank" rel="noopener" class="source-link">Source</a>
								)}
							</div>
						</article>
					))}
				</div>
			</section>
		)}
		
		<footer class="workshop-reflection">
			<p>Each project here connects to broader themes explored in my <a href="/blog/">writing</a> and contributes to the emerging patterns visible in the <a href="/tags/">themes</a> that naturally surface through this work.</p>
			
			<p class="meta-note">
				<em>Note: This presentation emphasizes the journey of exploration over formal categorization—another example of digital garden principles in practice. The timeline reveals how interests evolved and connected over time.</em>
			</p>
		</footer>
	</main>
</Layout>

<style>
	.workshop-header {
		text-align: center;
		margin-bottom: 3rem;
	}
	
	.workshop-header h1 {
		font-size: 2.4em;
		margin-bottom: 0.5rem;
		font-weight: 400;
		color: var(--text-primary);
	}
	
	.subtitle {
		font-size: 1.1em;
		color: var(--text-secondary);
		font-style: italic;
		margin: 0;
		line-height: 1.5;
	}
	
	.workshop-intro {
		margin-bottom: 3rem;
		padding: 2rem;
		background: var(--background-subtle);
		border-left: 3px solid var(--accent);
	}
	
	.workshop-intro p {
		font-size: 1.05em;
		line-height: 1.7;
		color: var(--text-primary);
		margin-bottom: 1.5rem;
	}
	
	.workshop-intro p:last-child {
		margin-bottom: 0;
	}
	
	.time-cluster {
		margin-bottom: 3rem;
	}
	
	.period-title {
		font-size: 1.6em;
		margin: 0 0 1rem 0;
		color: var(--text-primary);
		font-weight: 400;
		border-bottom: 1px solid var(--border-light);
		padding-bottom: 0.5rem;
	}
	
	.period-intro {
		font-size: 1em;
		color: var(--text-secondary);
		margin-bottom: 2rem;
		font-style: italic;
		line-height: 1.6;
	}
	
	.project-flow {
		display: flex;
		flex-direction: column;
		gap: 2rem;
	}
	
	.project-exploration {
		padding: 1.5rem 0;
		border-bottom: 1px solid var(--border-light);
	}
	
	.project-exploration:last-child {
		border-bottom: none;
	}
	
	.project-name {
		font-size: 1.3em;
		margin: 0 0 0.75rem 0;
		font-weight: 400;
	}
	
	.project-name a {
		color: var(--text-primary);
		text-decoration: none;
		transition: color 0.15s ease;
	}
	
	.project-name a:hover {
		color: var(--accent);
	}
	
	.project-narrative {
		color: var(--text-primary);
		line-height: 1.6;
		margin-bottom: 1rem;
		font-size: 1em;
	}
	
	.exploration-links {
		display: flex;
		gap: 1rem;
		align-items: center;
	}
	
	.explore-link {
		color: var(--accent);
		text-decoration: none;
		font-weight: 500;
		font-size: 0.9em;
	}
	
	.explore-link:hover {
		text-decoration: underline;
	}
	
	.source-link {
		color: var(--text-secondary);
		text-decoration: none;
		font-size: 0.85em;
		font-weight: 400;
	}
	
	.source-link:hover {
		color: var(--accent);
		text-decoration: underline;
	}
	
	.workshop-reflection {
		padding-top: 2rem;
		border-top: 1px solid var(--border);
		color: var(--text-secondary);
	}
	
	.workshop-reflection p {
		margin-bottom: 1.5rem;
		line-height: 1.6;
	}
	
	.workshop-reflection a {
		color: var(--accent);
		text-decoration: none;
	}
	
	.workshop-reflection a:hover {
		text-decoration: underline;
	}
	
	.meta-note {
		font-size: 0.9em;
		padding: 1.5rem;
		background: var(--background-subtle);
		border-radius: 4px;
		margin-top: 1rem;
	}
	
	.meta-note em {
		color: var(--text-secondary);
	}
	
	@media (max-width: 768px) {
		.workshop-header h1 {
			font-size: 2em;
		}
		
		.workshop-intro {
			padding: 1.5rem;
			margin-bottom: 2rem;
		}
		
		.period-title {
			font-size: 1.4em;
		}
		
		.project-exploration {
			padding: 1.25rem 0;
		}
	}
</style>